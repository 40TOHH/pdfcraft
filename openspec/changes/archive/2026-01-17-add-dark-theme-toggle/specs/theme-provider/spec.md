# Спецификация: ThemeProvider

## ADDED Requirements

### Requirement: Theme Context Provider
- **Описание**: Система SHALL предоставлять React Context для управления темой приложения
- **Реализация**: ThemeProvider компонент, оборачивающий приложение
- **Интерфейс**: 
  ```typescript
  interface ThemeContextType {
    theme: 'light' | 'dark';
    toggleTheme: () => void;
    setTheme: (theme: 'light' | 'dark') => void;
  }
  ```

#### Scenario: Инициализация ThemeProvider
- При запуске приложения
- Система определяет начальную тему на основе предпочтений пользователя или системных настроек
- Ожидаемый результат: ThemeProvider инициализируется с подходящей темой

### Requirement: Определение начальной темы
- **Описание**: Система SHALL определять начальную тему на основе следующего приоритета:
  1. Сохраненное значение в localStorage
  2. Системное предпочтение (prefers-color-scheme)
  3. По умолчанию светлая тема
- **Реализация**: Проверка localStorage и медиа-запроса prefers-color-scheme

#### Scenario: Определение начальной темы из localStorage
- При наличии сохраненной темы в localStorage
- Система использует сохраненное значение
- Ожидаемый результат: Приложение запускается с сохраненной темой

#### Scenario: Определение начальной темы из системных настроек
- При отсутствии сохраненной темы и наличии системного предпочтения
- Система использует системное предпочтение
- Ожидаемый результат: Приложение запускается с темой, соответствующей системным настройкам

### Requirement: Переключение темы
- **Описание**: Система SHALL позволять переключаться между светлой и темной темой
- **Реализация**: Функция toggleTheme, изменяющая состояние темы
- **Сайд-эффекты**: Обновление localStorage и класса .dark на html элементе

#### Scenario: Переключение темы с light на dark
- При вызове toggleTheme в состоянии 'light'
- Система изменяет тему на 'dark'
- Система сохраняет значение в localStorage
- Система добавляет класс .dark к html элементу
- Ожидаемый результат: Интерфейс переключается в темный режим

#### Scenario: Переключение темы с dark на light
- При вызове toggleTheme в состоянии 'dark'
- Система изменяет тему на 'light'
- Система сохраняет значение в localStorage
- Система удаляет класс .dark с html элемента
- Ожидаемый результат: Интерфейс переключается в светлый режим

### Requirement: Установка конкретной темы
- **Описание**: Система SHALL предоставлять возможность установить конкретную тему
- **Реализация**: Функция setTheme, принимающая 'light' или 'dark'
- **Сайд-эффекты**: Обновление localStorage и класса .dark на html элементе

#### Scenario: Установка светлой темы
- При вызове setTheme('light')
- Система устанавливает тему в 'light'
- Система сохраняет значение в localStorage
- Система удаляет класс .dark с html элемента
- Ожидаемый результат: Интерфейс переключается в светлый режим

#### Scenario: Установка темной темы
- При вызове setTheme('dark')
- Система устанавливает тему в 'dark'
- Система сохраняет значение в localStorage
- Система добавляет класс .dark к html элементу
- Ожидаемый результат: Интерфейс переключается в темный режим

### Requirement: Обработка гидратации
- **Описание**: Система SHALL корректно обрабатывать гидратацию в Next.js приложении
- **Реализация**: Проверка на клиенте до обновления DOM
- **Цель**: Избежать расхождений между серверным и клиентским рендерингом

#### Scenario: Гидратация на клиенте
- При гидратации Next.js приложения на клиенте
- Система проверяет, что код выполняется на клиенте
- Система обновляет DOM только после подтверждения клиентской среды
- Ожидаемый результат: Отсутствие ошибок гидратации